<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Joint Models for Longitudinal and Time-to-Event Data — jm • JMbayes2</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Joint Models for Longitudinal and Time-to-Event Data — jm" />
<meta property="og:description" content="Fits multivariate joint models for longitudinal and time-to-event data." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JMbayes2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Joint_Models.html">Univariate and Multivariate Joint Models</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/drizopoulos/JMbayes2/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Joint Models for Longitudinal and Time-to-Event Data</h1>
    
    <div class="hidden name"><code>jm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits multivariate joint models for longitudinal and time-to-event data.</p>
    </div>

    <pre class="usage"><span class='fu'>jm</span><span class='op'>(</span><span class='va'>Surv_object</span>, <span class='va'>Mixed_objects</span>, <span class='va'>time_var</span>, functional_forms <span class='op'>=</span> <span class='cn'>NULL</span>,
  data_Surv <span class='op'>=</span> <span class='cn'>NULL</span>, id_var <span class='op'>=</span> <span class='cn'>NULL</span>, priors <span class='op'>=</span> <span class='cn'>NULL</span>, control <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>value</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='fu'>slope</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='fu'>area</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='fu'>tv</span><span class='op'>(</span><span class='va'>x</span>, knots <span class='op'>=</span> <span class='cn'>NULL</span>, ord <span class='op'>=</span> <span class='fl'>2L</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Surv_object</th>
      <td><p>an object: <br /></p><ul>
<li><p>of class 'coxph' fitted by function <code>coxph()</code> from package <b>survival</b> or</p></li>
<li><p>of class 'survreg' fitted by function <code>survreg()</code> from package <b>survival</b></p></li>
</ul></td>
    </tr>
    <tr>
      <th>Mixed_objects</th>
      <td><p>a <code>list</code> of objects or a single object. Objects may be: <br /></p><ul>
<li><p>of class 'lme' fitted by function <code>lme()</code> from package <b>nlme</b> or</p></li>
<li><p>of class 'MixMod' fitted by function <code>mixed_model()</code> from package <b>GLMMadaptive</b></p></li>
</ul></td>
    </tr>
    <tr>
      <th>time_var</th>
      <td><p>a <code>character</code> string indicating the time variable in the mixed effects model.</p></td>
    </tr>
    <tr>
      <th>functional_forms</th>
      <td><p>a <code>list</code> of formulas. Each formula corresponds to one longitudinal outcome and specifies the association structure between that outcome and the survival submodel as well as any interaction terms between the components of the longitudinal outcome and the survival submodel. See <b>Examples</b>.</p></td>
    </tr>
    <tr>
      <th>data_Surv</th>
      <td><p>the <code>data.frame</code> used to fit the Cox/AFT survival submodel.</p></td>
    </tr>
    <tr>
      <th>id_var</th>
      <td><p>a <code>character</code> string indicating the id variable in the survival submodel.</p></td>
    </tr>
    <tr>
      <th>priors</th>
      <td><p>a named <code>list</code> of user-specified prior parameters:</p><dl>
        <dt><code>mean_betas_HC</code></dt><dd><p>the prior mean vectors of the normal prior for the regression coefficients of the covariates of the longitudinal model(s) which were Hierarchically Centered</p></dd>
        <dt><code>Tau_betas_HC</code></dt><dd><p>the prior precision matrix of the normal prior for the regression coefficients of the longitudinal model(s) which were Hierarchically Centered</p></dd>
        <dt><code>mean_betas_nHC</code></dt><dd><p>the prior mean vectors of the normal prior for the regression coefficients of the covariates of the longitudinal model(s) which were not Hierarchically Centered</p></dd>
        <dt><code>Tau_betas_nHC</code></dt><dd><p>the prior precision matrix of the normal prior for the regression coefficients of the longitudinal model(s) which were not Hierarchically Centered</p></dd>
        <dt><code>mean_bs_gammas</code></dt><dd><p>the prior mean vector of the normal prior for the B-splines 
            coefficients used to approximate the baseline hazard.</p></dd>
        <dt><code>Tau_bs_gammas</code></dt><dd><p>the prior precision matrix of the normal prior for the B-splines 
            coefficients used to approximate the baseline hazard.</p></dd>
        <dt><code>A_tau_bs_gammas</code></dt><dd><p>the prior shape parameter of the Gamma prior for the
            precision parameter of the penalty term for the B-splines coefficients for
            the baseline hazard.</p></dd>
        <dt><code>B_tau_bs_gammas</code></dt><dd><p>the prior rate parameter of the Gamma prior for the
            precision parameter of the penalty term for the B-splines coefficients for
            the baseline hazard.</p></dd>
        <dt><code>rank_Tau_bs_gammas</code></dt><dd><p>The prior rank parameter for the precision matrix of the normal prior for the B-splines coefficients used to approximate the baseline hazard.</p></dd>
        <dt><code>mean_gammas</code></dt><dd><p>the prior mean vector of the normal prior for the regression 
            coefficients of baseline covariates.</p></dd>
        <dt><code>Tau_gammas</code></dt><dd><p>the prior precision matrix of the normal prior for the regression 
            coefficients of baseline covariates.</p></dd>
        <dt><code>penalty_gammas</code></dt><dd><p>a character string with value: 'none', 'ridge', 'horseshoe' indicating whether the coefficients of the baseline covariates included in the survival submodel should not be shrinked, shrinked using ridge prior or shrinked using horseshoe prior respectively.</p></dd>
        <dt><code>A_lambda_gammas</code></dt><dd><p>the prior shape parameter of the Gamma prior for the
            precision parameter of the local penalty term for the baseline regression coefficients. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>B_lambda_gammas</code></dt><dd><p>the prior rate parameter of the Gamma prior for the
            precision parameter of the local penalty term for the baseline regression coefficients. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>A_tau_gammas</code></dt><dd><p>the prior shape parameter of the Gamma prior for the
            precision parameter of the global penalty term for the baseline regression coefficients. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>B_tau_gammas</code></dt><dd><p>the prior rate parameter of the Gamma prior for the
            precision parameter of the global penalty term for the baseline regression coefficients. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>A_nu_gammas</code></dt><dd><p>the prior shape parameter of the Gamma prior for the variance hyperparameter for the precision parameter of the local penalty term for the baseline regression coefficients. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>B_nu_gammas</code></dt><dd><p>the prior rate parameter of the Gamma prior for the variance hyperparameter for the precision parameter of the local penalty term for the baseline regression coefficients. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>A_xi_gammas</code></dt><dd><p>the prior shape parameter of the Gamma prior for the variance hyperparameter for the precision parameter of the global penalty term for the baseline regression coefficients. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>B_xi_gammas</code></dt><dd><p>the prior rate parameter of the Gamma prior for the variance hyperparameter for the precision parameter of the global penalty term for the baseline regression coefficients. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>mean_alphas</code></dt><dd><p>the prior mean vector of the normal prior for the association
            parameters.</p></dd>
        <dt><code>Tau_alphas</code></dt><dd><p>the prior mean vector of the normal prior for the association
            parameters.</p></dd>
        <dt><code>penalty_alphas</code></dt><dd><p>a character string with value: 'none', 'ridge', 'horseshoe' indicating whether the coefficients association parameters should not be shrinked, shrinked using ridge prior or shrinked using horseshoe prior respectively.</p></dd>
        <dt><code>A_lambda_alphas</code></dt><dd><p>the prior shape parameter of the Gamma prior for the
            precision parameter of the local penalty term for the association parameters. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>B_lambda_alphas</code></dt><dd><p>the prior rate parameter of the Gamma prior for the
            precision parameter of the local penalty term for the association parameters. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>A_tau_alphas</code></dt><dd><p>the prior shape parameter of the Gamma prior for the
            precision parameter of the global penalty term for the association parameters. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>B_tau_alphas</code></dt><dd><p>the prior rate parameter of the Gamma prior for the
            precision parameter of the global penalty term for the association parameters. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>A_nu_alphas</code></dt><dd><p>the prior shape parameter of the Gamma prior for the variance hyperparameter for the precision parameter of the local penalty term for the association parameters. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>B_nu_alphas</code></dt><dd><p>the prior rate parameter of the Gamma prior for the variance hyperparameter for the precision parameter of the local penalty term for the association parameters. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>A_xi_alphas</code></dt><dd><p>the prior shape parameter of the Gamma prior for the variance hyperparameter for the precision parameter of the global penalty term for the association parameters. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>B_xi_alphas</code></dt><dd><p>the prior rate parameter of the Gamma prior for the variance hyperparameter for the precision parameter of the global penalty term for the association parameters. Only relevant when <code>penalty_gammas = 'ridge'</code> or when <code>penalty_gammas = 'horseshoe'</code></p></dd>
        <dt><code>gamma_prior_D_sds</code></dt><dd><p>logical; if <code>TRUE</code> a Gamma prior will be used for the standard deviations of the D matrix (variance-covariance matrix of the random effects). Deafult is <code>TRUE</code></p></dd>
        <dt><code>D_sds_df</code></dt><dd><p>the prior degrees of freedom parameter for the half-t prior for the standard deviations of the D matrix (variance-covariance matrix of the random effects).</p></dd>
        <dt><code>D_sds_sigma</code></dt><dd><p>the prior sigma parameter vector for the half-t prior for the standard deviations of the D matrix (variance-covariance matrix of the random effects).</p></dd>
        <dt><code>D_sds_shape</code></dt><dd><p>the prior shape parameter for the Gamma prior for the standard deviations of the D matrix (variance-covariance matrix of the random effects).</p></dd>
        <dt><code>D_sds_mean</code></dt><dd><p>the prior mean parameter vector for the Gamma prior for the standard deviations of the D matrix (variance-covariance matrix of the random effects).</p></dd>
        <dt><code>D_L_etaLKJ</code></dt><dd><p>the prior eta parameter for the LKJ prior for the correlation matrix of the random effects).</p></dd>
        <dt><code>sigmas_df</code></dt><dd><p>the prior degrees of freedom parmeter for the half-t prior for the error term(s).</p></dd>
        <dt><code>sigmas_sigma</code></dt><dd><p>the prior sigma parmeter for the half-t prior for the error term(s).</p></dd>
    
</dl>
</td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list of control values with components:</p><dl>
        <dt><code>GK_k</code></dt><dd><p>number of quadrature points for the Gauss Kronrod rule; options 15 and 7.</p></dd>
        <dt><code>Bsplines_degree</code></dt><dd><p>the degree of the splines in each basis; default quadratic splines.</p></dd>
        <dt><code>base_hazard_segments</code></dt><dd><p>number of segments to split the follow-up period; default is 10.</p></dd>
        <dt><code>diff</code></dt><dd><p>the order of the difference used in the penalty matrix for the B-splines for h_0; default is 2.</p></dd>
        <dt><code>n_chains</code></dt><dd><p>integer specifying the number of chains for the MCMC. default is 3.</p></dd>
        <dt><code>n_burnin</code></dt><dd><p>integer specifying the number of burn-in iterations. default is 500.</p></dd>
        <dt><code>n_iter</code></dt><dd><p>integer specifying the number of total iterations per chain. default is 3500.</p></dd>
        <dt><code>seed</code></dt><dd><p>the seed used in the sampling procedures; default is 123.</p></dd>
        <dt><code>MALA</code></dt><dd><p><code>logical</code>; if TRUE, the MALA algorithm is used when update the elements of the Cholesky factor of the D matrix. default is <code>FALSE</code>.</p></dd>
        <dt><code>save_random_effects</code></dt><dd><p><code>logical</code>; if TRUE, the full MCMC rsults of the random effects will be saved and returned with the <code>jm</code> object. default is <code>FALSE</code>.</p></dd>
        <dt><code>cores</code></dt><dd><p>an integer specifying the number of cores to use. Default is the
            the available cores minus one.</p></dd>
    
</dl><p></p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>.</p></td>
    </tr>
    <tr>
      <th>knots, ord</th>
      <td><p>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed to <code>control</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>XXX</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code>jm</code> with components:</p>
<dt>mcmc</dt><dd><p>a <code>list</code> with the MCMC samples for each parameter.</p></dd>
<dt>acc_rates</dt><dd><p>a <code>list</code> with the acceptance rates for each parameter.</p></dd>
<dt>logLik</dt><dd><p>a <code>matrix</code> of dimensions [<code>((n_iter - n_burnin)/n_thin)*n_thin</code>, number of individuals] with element [i, j] the conditional log-Likelihood value of the \(i^{th}\) iteration for the \(j^{th}\) individual.</p></dd>
<dt>mlogLik</dt><dd><p>a <code>matrix</code> of dimensions [<code>((n_iter - n_burnin)/n_thin)*n_thin</code>, number of individuals] with element [i, j] the marginal log-Likelihood value of the \(i^{th}\) iteration for the \(j^{th}\) individual.</p></dd>
<dt>running_time</dt><dd><p>an object of class <code>proc_time</code> with the time used to run <code>jm</code></p></dd>
<dt>statistics</dt><dd><p>a <code>list</code> with posterior estimates of the parameters (means, medians, standard deviations, standard errors, effective sample sizes, tail probabilities, upper and lower bounds of credible intervals, etc.).</p></dd>
<dt>fit_stats</dt><dd><p>a <code>list</code> of lists with fit statistics (DIC, pD, LPML, CPO, WAIC) for both conditional and marginal formulation.</p></dd>
<dt>model_data</dt><dd><p>a <code>list</code> of data used to fit the model.</p></dd>
<dt>model_info</dt><dd><p>a <code>list</code> of components of the fit useful to other functions.</p></dd>
<dt>initial_values</dt><dd><p>a <code>list</code> with the initial values of the parameters.</p></dd>
<dt>control</dt><dd><p>a copy of the <code>control</code> values used to fit the model.</p></dd>
<dt>priors</dt><dd><p>a copy of the <code>priors</code> used to fit the model.</p></dd>
<dt>call</dt><dd><p>the matched call</p></dd>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Dimitris Rizopoulos <a href='mailto:d.rizopoulos@erasmusmc.nl'>d.rizopoulos@erasmusmc.nl</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='jm Methods.html'>methods.jm</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>##########################################################################################</span>

<span class='co'>##############################################</span>
<span class='co'># Univariate joint model for serum bilirubin #</span>
<span class='co'># 1 continuous outcome                       #                       </span>
<span class='co'>##############################################</span>

<span class='co'># [1] Fit the mixed model using lme(). </span>
<span class='va'>fm1</span> <span class='op'>&lt;-</span> <span class='fu'>lme</span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>serBilir</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>year</span> <span class='op'>*</span> <span class='va'>sex</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>year</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> 
           <span class='va'>age</span> <span class='op'>+</span> <span class='va'>prothrombin</span>, random <span class='op'>=</span>  <span class='op'>~</span> <span class='va'>year</span> <span class='op'>|</span> <span class='va'>id</span>, data <span class='op'>=</span> <span class='va'>pbc2</span><span class='op'>)</span>

<span class='co'># [2] Fit a Cox model, specifying the baseline covariates to be included in the joint</span>
<span class='co'># model; </span>
<span class='va'>fCox1</span> <span class='op'>&lt;-</span> <span class='fu'>coxph</span><span class='op'>(</span><span class='fu'>Surv</span><span class='op'>(</span><span class='va'>years</span>, <span class='va'>status2</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>drug</span> <span class='op'>+</span> <span class='va'>age</span>, data <span class='op'>=</span> <span class='va'>pbc2.id</span><span class='op'>)</span>

<span class='co'># [3] The basic joint model is fitted using a call to jm() i.e.,</span>
<span class='va'>joint_model_fit_1</span> <span class='op'>&lt;-</span> <span class='fu'>jm</span><span class='op'>(</span><span class='va'>fCox1</span>, <span class='va'>fm1</span>, time_var <span class='op'>=</span> <span class='st'>"year"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>joint_model_fit_1</span><span class='op'>)</span>
<span class='fu'><a href='jm coda Methods.html'>traceplot</a></span><span class='op'>(</span><span class='va'>joint_model_fit_1</span><span class='op'>)</span>

<span class='co'>##########################################################################################</span>

<span class='co'>#############################################################################################</span>
<span class='co'># Multivariate joint model for serum bilirubin, hepatomegaly and ascites                    # </span>
<span class='co'>#############################################################################################</span>

<span class='co'># [1] Fit the mixed-effects models using lme() for continuous </span>
<span class='co'># outcomes and mixed_model() for categorical outcomes. </span>
<span class='va'>fm1</span> <span class='op'>&lt;-</span> <span class='fu'>lme</span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>serBilir</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>year</span> <span class='op'>*</span> <span class='va'>sex</span>, 
           random <span class='op'>=</span>  <span class='op'>~</span> <span class='va'>year</span> <span class='op'>|</span> <span class='va'>id</span>, data <span class='op'>=</span> <span class='va'>pbc2</span><span class='op'>)</span>

<span class='va'>fm2</span> <span class='op'>&lt;-</span> <span class='fu'>mixed_model</span><span class='op'>(</span><span class='va'>hepatomegaly</span> <span class='op'>~</span> <span class='va'>sex</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>year</span>, data <span class='op'>=</span> <span class='va'>pbc2</span>, 
                   random <span class='op'>=</span> <span class='op'>~</span> <span class='va'>year</span> <span class='op'>|</span> <span class='va'>id</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>fm3</span> <span class='op'>&lt;-</span> <span class='fu'>mixed_model</span><span class='op'>(</span><span class='va'>ascites</span> <span class='op'>~</span> <span class='va'>year</span> <span class='op'>+</span> <span class='va'>age</span>, data <span class='op'>=</span> <span class='va'>pbc2</span>,
                   random <span class='op'>=</span> <span class='op'>~</span> <span class='va'>year</span> <span class='op'>|</span> <span class='va'>id</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># [2] Save all the fitted mixed-effects models in a list</span>
<span class='va'>Mixed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fm1</span>, <span class='va'>fm2</span>, <span class='va'>fm3</span><span class='op'>)</span>

<span class='co'># [3] Fit a Cox model, specifying the baseline covariates to be included in the joint</span>
<span class='co'># model; </span>
<span class='va'>fCox1</span> <span class='op'>&lt;-</span> <span class='fu'>coxph</span><span class='op'>(</span><span class='fu'>Surv</span><span class='op'>(</span><span class='va'>years</span>, <span class='va'>status2</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>drug</span> <span class='op'>+</span> <span class='va'>age</span>, data <span class='op'>=</span> <span class='va'>pbc2.id</span><span class='op'>)</span>

<span class='co'># [4] The joint model is fitted using a call to jm() i.e.,</span>
<span class='va'>joint_model_fit_2</span> <span class='op'>&lt;-</span> <span class='fu'>jm</span><span class='op'>(</span><span class='va'>fCox1</span>, <span class='va'>Mixed</span>, time_var <span class='op'>=</span> <span class='st'>"year"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>joint_model_fit_2</span><span class='op'>)</span>
<span class='fu'><a href='jm coda Methods.html'>traceplot</a></span><span class='op'>(</span><span class='va'>joint_model_fit_2</span><span class='op'>)</span>

<span class='co'>##########################################################################################</span>

<span class='co'>#############################################################################################</span>
<span class='co'># Slopes &amp; Area Terms                                                                       # </span>
<span class='co'>#############################################################################################</span>

<span class='co'># We extend model 'joint_model_fit_2' by including the value and slope term for bilirubin, the</span>
<span class='co'># the area term for hepatomegaly (in the log-odds scale) and the value and </span>
<span class='co'># area term for spiders (in the log-odds scale). </span>
<span class='co'># To include these terms into the model we specify the 'functional_forms' argument. This should be </span>
<span class='co'># a list of right side formulas. Each component of the list should </span>
<span class='co'># have as name the name of the corresponding</span>
<span class='co'># outcome variable. In the right side formula we specify the functional form </span>
<span class='co'># of the association using</span>
<span class='co'># functions 'value()', 'slope()' and 'area()'.</span>
<span class='co'># Notes: (1) For terms not specified in the 'functional_forms' list, the default value functional</span>
<span class='co'># form is used. </span>

<span class='co'># [1] Fit the mixed-effects models using lme() for continuous outcomes </span>
<span class='co'># and mixed_model() for categorical outcomes. </span>
<span class='va'>fm1</span> <span class='op'>&lt;-</span> <span class='fu'>lme</span><span class='op'>(</span>fixed <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>serBilir</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>year</span> <span class='op'>*</span> <span class='va'>sex</span>, random <span class='op'>=</span>  <span class='op'>~</span> <span class='va'>year</span> <span class='op'>|</span> <span class='va'>id</span>, data <span class='op'>=</span> <span class='va'>pbc2</span><span class='op'>)</span>

<span class='va'>fm2</span> <span class='op'>&lt;-</span> <span class='fu'>mixed_model</span><span class='op'>(</span><span class='va'>hepatomegaly</span> <span class='op'>~</span> <span class='va'>sex</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>year</span>, data <span class='op'>=</span> <span class='va'>pbc2</span>, 
                   random <span class='op'>=</span> <span class='op'>~</span> <span class='va'>year</span> <span class='op'>|</span> <span class='va'>id</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>fm3</span> <span class='op'>&lt;-</span> <span class='fu'>mixed_model</span><span class='op'>(</span><span class='va'>ascites</span> <span class='op'>~</span> <span class='va'>year</span> <span class='op'>+</span> <span class='va'>age</span>, data <span class='op'>=</span> <span class='va'>pbc2</span>,
                   random <span class='op'>=</span> <span class='op'>~</span> <span class='va'>year</span> <span class='op'>|</span> <span class='va'>id</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># [2] Save all the fitted mixed-effects models in a list</span>
<span class='va'>Mixed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>fm1</span>, <span class='va'>fm2</span>, <span class='va'>fm3</span><span class='op'>)</span>

<span class='co'># [3] Fit a Cox model, specifying the baseline covariates to be included in the joint</span>
<span class='co'># model; </span>
<span class='va'>fCox1</span> <span class='op'>&lt;-</span> <span class='fu'>coxph</span><span class='op'>(</span><span class='fu'>Surv</span><span class='op'>(</span><span class='va'>years</span>, <span class='va'>status2</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>drug</span> <span class='op'>+</span> <span class='va'>age</span>, data <span class='op'>=</span> <span class='va'>pbc2.id</span><span class='op'>)</span>

<span class='co'># [4] Specify the list of formulas to be passed to the functional_forms argument of jm()</span>
<span class='va'>fForms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"log(serBilir)"</span> <span class='op'>=</span> <span class='op'>~</span> <span class='fu'>value</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>serBilir</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>slope</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>serBilir</span><span class='op'>)</span><span class='op'>)</span>,
               <span class='st'>"hepatomegaly"</span> <span class='op'>=</span> <span class='op'>~</span> <span class='fu'>area</span><span class='op'>(</span><span class='va'>hepatomegaly</span><span class='op'>)</span>,
               <span class='st'>"ascites"</span> <span class='op'>=</span> <span class='op'>~</span> <span class='fu'>value</span><span class='op'>(</span><span class='va'>ascites</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>area</span><span class='op'>(</span><span class='va'>ascites</span><span class='op'>)</span><span class='op'>)</span>
               
<span class='co'># [5] The joint model is fitted using a call to jm() and passing the list </span>
<span class='co'># to the functional_forms argument</span>
<span class='va'>joint_model_fit_2</span> <span class='op'>&lt;-</span> <span class='fu'>jm</span><span class='op'>(</span><span class='va'>fCox1</span>, <span class='va'>Mixed</span>, time_var <span class='op'>=</span> <span class='st'>"year"</span>, functional_forms <span class='op'>=</span> <span class='va'>fForms</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>joint_model_fit_2</span><span class='op'>)</span>


<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://www.drizopoulos.com/'>Dimitris Rizopoulos</a>, <a href='https://gregpapageorgiou.com/'>Grigorios Papageorgiou</a>, <a href='https://pafonso.com/'>Pedro Miranda Afonso</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


